<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quiz Arbitrage Football</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #1a1a1a, #2c2c2c);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px 20px 80px 20px;
        }

        .container {
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2);
            max-width: 700px;
            width: 100%;
            overflow: hidden;
            animation: slideIn 0.8s ease-out;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .header {
            background: linear-gradient(135deg, #1a1a1a, #2c2c2c);
            color: #ffd700;
            padding: 30px;
            text-align: center;
            position: relative;
            overflow: hidden;
            border-bottom: 3px solid #ffd700;
        }

        .header::before {
            content: '‚öΩ';
            position: absolute;
            font-size: 100px;
            opacity: 0.1;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            animation: spin 10s linear infinite;
        }

        @keyframes spin {
            from { transform: translate(-50%, -50%) rotate(0deg); }
            to { transform: translate(-50%, -50%) rotate(360deg); }
        }

        .header h1 {
            font-size: 2.2em;
            margin-bottom: 10px;
            position: relative;
            z-index: 1;
        }

        .header p {
            opacity: 0.9;
            position: relative;
            z-index: 1;
        }

        .form-container {
            padding: 40px;
        }

        .form-group {
            margin-bottom: 25px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: #1a1a1a;
            font-size: 1.1em;
        }

        input[type="text"], select {
            width: 100%;
            padding: 15px;
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            font-size: 1em;
            transition: all 0.3s ease;
            background: white;
        }

        input[type="text"]:focus, select:focus {
            outline: none;
            border-color: #ffd700;
            box-shadow: 0 0 0 3px rgba(255, 215, 0, 0.1);
            transform: translateY(-2px);
        }

        select {
            cursor: pointer;
            appearance: none;
            background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%23ffd700' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6,9 12,15 18,9'%3e%3c/polyline%3e%3c/svg%3e");
            background-repeat: no-repeat;
            background-position: right 15px center;
            background-size: 20px;
            padding-right: 45px;
        }

        .mode-selection {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }

        .mode-card {
            padding: 20px;
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
        }

        .mode-card:hover {
            border-color: #ffd700;
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(255, 215, 0, 0.2);
        }

        .mode-card.selected {
            border-color: #ffd700;
            background: #fff8dc;
        }

        .mode-card h3 {
            color: #1a1a1a;
            margin-bottom: 10px;
        }

        .mode-card p {
            color: #666;
            font-size: 0.9em;
        }

        .btn {
            background: linear-gradient(135deg, #ffd700, #b8860b);
            color: #1a1a1a;
            border: none;
            padding: 15px 30px;
            border-radius: 12px;
            font-size: 1.1em;
            font-weight: bold;
            cursor: pointer;
            width: 100%;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(255, 215, 0, 0.3);
        }

        .btn:active {
            transform: translateY(-1px);
        }

        .hidden {
            display: none;
        }

        .quiz-container {
            padding: 40px;
        }

        .user-info {
            background: linear-gradient(135deg, #ffd700, #fff8dc);
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 30px;
            border-left: 5px solid #1a1a1a;
            color: #1a1a1a;
        }

        .timer-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .timer {
            background: #ff4444;
            color: white;
            padding: 10px 20px;
            border-radius: 50px;
            font-weight: bold;
            font-size: 1.2em;
            animation: pulse 1s infinite;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        .timer.warning {
            background: #ff8800;
        }

        .timer.normal {
            background: #4caf50;
            animation: none;
        }

        .question-card {
            background: linear-gradient(135deg, #f9f9f9, #f0f0f0);
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.05);
            border: 2px solid #ffd700;
        }

        .question-number {
            background: #1a1a1a;
            color: #ffd700;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            margin-bottom: 20px;
            font-size: 1.2em;
        }

        .question-text {
            font-size: 1.2em;
            margin-bottom: 20px;
            color: #1a1a1a;
            font-weight: 600;
            line-height: 1.5;
        }

        .options {
            display: grid;
            gap: 12px;
            margin-bottom: 20px;
        }

        .option {
            padding: 15px 20px;
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            background: white;
            font-size: 1em;
            position: relative;
        }

        .option:hover {
            border-color: #ffd700;
            background: #fff8dc;
            transform: translateX(5px);
        }

        .option.selected {
            background: #1a1a1a;
            color: #ffd700;
            border-color: #ffd700;
        }

        .option.correct {
            background: #4caf50;
            color: white;
            border-color: #4caf50;
        }

        .option.incorrect {
            background: #f44336;
            color: white;
            border-color: #f44336;
        }

        .option .feedback-icon {
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 1.2em;
        }

        .theme-badge {
            display: inline-block;
            background: #1a1a1a;
            color: #ffd700;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.8em;
            margin-bottom: 15px;
            text-transform: uppercase;
            font-weight: bold;
            border: 1px solid #ffd700;
        }

        .difficulty-badge {
            display: inline-block;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.8em;
            margin-left: 10px;
            font-weight: bold;
        }

        .difficulty-easy { background: #90EE90; color: #006400; }
        .difficulty-medium { background: #FFD700; color: #B8860B; }
        .difficulty-hard { background: #FFB6C1; color: #DC143C; }

        .answer-explanation {
            background: #e8f5e8;
            border: 1px solid #4caf50;
            border-radius: 10px;
            padding: 15px;
            margin-top: 15px;
            color: #2e7d32;
        }

        .navigation {
            display: flex;
            gap: 15px;
            justify-content: space-between;
            margin-top: 30px;
        }

        .nav-btn {
            padding: 12px 24px;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
        }

        .nav-btn.prev {
            background: #e0e0e0;
            color: #666;
        }

        .nav-btn.next, .nav-btn.finish {
            background: #ffd700;
            color: #1a1a1a;
            font-weight: bold;
        }

        .nav-btn:hover {
            transform: translateY(-2px);
        }

        .nav-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .results {
            text-align: center;
            padding: 40px;
        }

        .score-circle {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            background: conic-gradient(#ffd700 0deg, #ffd700 calc(var(--score) * 3.6deg), #e0e0e0 calc(var(--score) * 3.6deg));
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 30px;
            position: relative;
        }

        .score-inner {
            width: 120px;
            height: 120px;
            background: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
            font-size: 2em;
            font-weight: bold;
            color: #1a1a1a;
            border: 2px solid #ffd700;
        }

        .weakness-analysis {
            background: #fff8dc;
            border: 2px solid #ffd700;
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
            text-align: left;
        }

        .weakness-analysis h3 {
            color: #1a1a1a;
            margin-bottom: 15px;
        }

        .weakness-item {
            background: white;
            padding: 10px 15px;
            margin: 10px 0;
            border-radius: 8px;
            border-left: 4px solid #ff8800;
        }

        .correction-details {
            background: #f5f5f5;
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
            text-align: left;
        }

        .correction-item {
            background: white;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        .correction-item.wrong {
            border-left: 4px solid #f44336;
        }

        .correction-item h4 {
            color: #1a1a1a;
            margin-bottom: 10px;
        }

        .user-answer {
            color: #f44336;
            font-weight: bold;
        }

        .correct-answer {
            color: #4caf50;
            font-weight: bold;
        }

        .results-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 30px;
        }

        .btn-secondary {
            background: #e0e0e0;
            color: #1a1a1a;
            border: none;
            padding: 12px 24px;
            border-radius: 10px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
        }

        .btn-secondary:hover {
            background: #d0d0d0;
            transform: translateY(-2px);
        }

        @media (max-width: 768px) {
            .container {
                margin: 10px;
            }
            
            .form-container, .quiz-container {
                padding: 20px;
            }
            
            .header {
                padding: 20px;
            }
            
            .header h1 {
                font-size: 1.8em;
            }

            .mode-selection {
                grid-template-columns: 1fr;
            }

            .results-buttons {
                flex-direction: column;
            }
        }
    </style>
</head>
<div id="popupWelcome" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.8); z-index:9999; align-items:center; justify-content:center;">
    <div style="background:#fff; border-radius:10px; padding:30px; max-width:500px; text-align:center;">
        <p>Amis arbitres, nous avons con√ßu une banque de 500 questions pour perfectionner notre ma√Ætrise des Lois du Jeu.</p>
        <p>Chaque test propose 15 questions, en mode r√©vision ou en mode challenge.</p>
        <p>Un score et des corrections compl√®tes vous seront communiqu√©s en fin de session.</p>
        <p>Relevez le d√©fi et rejoignez-nous dans cette dynamique d‚Äôam√©lioration continue !</p>
        <button onclick="dismissPopup()" class="btn" style="margin-top:20px;">Continuer</button>
    </div>
</div>
<body>
    <div class="container">
        <!-- √âcran d'identification -->
        <div id="loginScreen">
            <div class="header">
                <h1>Quiz Arbitrage Football</h1>
                <p>Testez vos connaissances des r√®gles du football</p>
			
            </div>
            <div class="form-container">
                <form id="loginForm">
                    <div class="form-group">
							
				
                        <label for="firstName">Pr√©nom :</label>
                        <input type="text" id="firstName" name="firstName" required placeholder="Votre pr√©nom">
                    </div>
                    
                    <div class="form-group">
                        <label for="lastName">Nom :</label>
                        <input type="text" id="lastName" name="lastName" required placeholder="Votre nom">
                    </div>
                    
                    <div class="form-group">
                        <label for="role">R√¥le d'arbitrage :</label>
                        <select id="role" name="role" required>
                            <option value="">S√©lectionnez votre r√¥le</option>
                            <option value="central">Arbitre Central</option>
                            <option value="assistant">Arbitre Assistant</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="level">Niveau d'arbitrage :</label>
                        <select id="level" name="level" required>
                            <option value="">S√©lectionnez votre niveau</option>
                            <option value="D4">D4 - District 4</option>
                            <option value="D3">D3 - District 3</option>
                            <option value="D2">D2 - District 2</option>
                            <option value="D1">D1 - District 1</option>
                            <option value="R3">R3 - R√©gional 3</option>
                            <option value="R2">R2 - R√©gional 2</option>
                            <option value="R1">R1 - R√©gional 1</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label>Mode de quiz :</label>
                        <div class="mode-selection">
                            <div class="mode-card" data-mode="training">
                                <h3>Mode entra√Ænement</h3>
                                <p>R√©ponses affich√©es imm√©diatement avec explications</p>
                            </div>
                            <div class="mode-card" data-mode="exam">
                                <h3>Mode examen</h3>
                                <p>20 secondes par question, correction √† la fin</p>
                            </div>
                        </div>
                        <input type="hidden" id="quizMode" name="quizMode" required>
                    </div>
                    
                    <button type="submit" class="btn">Commencer le Quiz</button>
                </form>
            </div>
        </div>

        <!-- √âcran de quiz -->
        <div id="quizScreen" class="hidden">
            <div class="header">
                <h1>Quiz en cours</h1>
                <div class="timer-container">
                    <p id="progressText">Question 1 sur 15</p>
                    <div id="timerDisplay" class="timer hidden">20s</div>
                </div>
            </div>
            <div class="quiz-container">
                <div class="user-info">
                    <strong id="userDisplay"></strong>
                    <span id="roleDisplay"></span>
                    <span id="levelDisplay"></span>
                    <span id="modeDisplay"></span>
                </div>
                
                <div id="questionCard" class="question-card">
                    <div class="question-number" id="questionNumber">1</div>
                    <div class="theme-badge" id="themeBadge"></div>
                    <div class="difficulty-badge" id="difficultyBadge"></div>
                    <div class="question-text" id="questionText"></div>
                    <div class="options" id="optionsContainer"></div>
                    <div id="answerExplanation" class="answer-explanation hidden"></div>
                </div>

                <div class="navigation">
                    <button class="nav-btn prev" id="prevBtn" onclick="previousQuestion()" disabled>Pr√©c√©dent</button>
                    <button class="nav-btn next" id="nextBtn" onclick="nextQuestion()">Suivant</button>
                    <button class="nav-btn finish hidden" id="finishBtn" onclick="finishQuiz()">Terminer</button>
                </div>
            </div>
        </div>

        <!-- √âcran de r√©sultats -->
        <div id="resultScreen" class="hidden">
            <div class="header">
                <h1>R√©sultats du Quiz</h1>
                <p>Voici votre score</p>
            </div>
            <div class="results">
                <div class="user-info">
                    <strong id="finalUserDisplay"></strong>
                    <span id="finalRoleDisplay"></span>
                    <span id="finalLevelDisplay"></span>
                    <span id="finalModeDisplay"></span>
                </div>
                
                <div class="score-circle" id="scoreCircle">
                    <div class="score-inner">
                        <div id="scorePercentage">0%</div>
                        <div style="font-size: 0.5em;" id="scoreText">0/15</div>
                    </div>
                </div>

                <div id="feedback" style="font-size: 1.2em; margin: 20px 0; color: #2c5530;"></div>

                <div id="weaknessAnalysis" class="weakness-analysis hidden">
                    <h3>üìö Points √† revoir :</h3>
                    <div id="weaknessList"></div>
                </div>

                <div id="correctionDetails" class="correction-details hidden">
                    <h3>‚ùå Questions avec erreurs :</h3>
                    <div id="correctionList"></div>
                </div>

                <div class="results-buttons">
                    <button class="btn" onclick="newTest()">Faire un autre test</button>
                    <button class="btn-secondary" onclick="restartQuiz()">‚öΩ Page d'accueil</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer style="position: fixed; bottom: 0; left: 0; right: 0; background: linear-gradient(135deg, #1a1a1a, #2c2c2c); color: #ffd700; text-align: center; padding: 15px; font-size: 0.9em; font-weight: bold; border-top: 2px solid #ffd700; z-index: 1000;">
        ATKAN ACADEMY - Tous droits r√©serv√©s 2025 ¬Æ 
    </footer>

    <script>
        // Questions organis√©es par r√¥le d'arbitrage avec toutes les nouvelles questions du document
        const questionsByRole = {
            central: [
                // Loi 1 : Le terrain de jeu
                {
                    "question": "Quelle est la largeur maximale autoris√©e d'un terrain de football international ?",
                    "options": ["68 m", "75 m", "90 m", "100 m"],
                    "answer": "68 m",
                    "theme": "Loi 1 - Terrain",
                    "difficulty": "medium",
                    "explanation": "Pour les matchs internationaux, la largeur maximale est de 68 m√®tres."
                },
                {
                    "question": "Quelle est la longueur minimale d'un terrain pour un match international ?",
                    "options": ["90 m", "100 m", "105 m", "110 m"],
                    "answer": "105 m",
                    "theme": "Loi 1 - Terrain",
                    "difficulty": "medium",
                    "explanation": "Pour les matchs internationaux, la longueur minimale est de 105 m√®tres."
                },
                {
                    "question": "Quelle est la taille standard d'un but de football ?",
                    "options": ["7,32 m de large et 2,44 m de haut", "7 m de large et 2,50 m de haut", "8 m de large et 2,40 m de haut", "7,50 m de large et 2,45 m de haut"],
                    "answer": "7,32 m de large et 2,44 m de haut",
                    "theme": "Loi 1 - Terrain",
                    "difficulty": "easy",
                    "explanation": "Les buts mesurent exactement 7,32 m de largeur et 2,44 m de hauteur."
                },
                {
                    "question": "Le rond central a quel rayon ?",
                    "options": ["7,32 m", "8 m", "9,15 m", "10 m"],
                    "answer": "9,15 m",
                    "theme": "Loi 1 - Terrain",
                    "difficulty": "easy",
                    "explanation": "Le cercle central a un rayon de 9,15 m√®tres."
                },
                {
                    "question": "La surface de r√©paration mesure :",
                    "options": ["12 m √ó 20 m", "16,5 m √ó 40,3 m", "18 m √ó 40 m", "20 m √ó 50 m"],
                    "answer": "16,5 m √ó 40,3 m",
                    "theme": "Loi 1 - Terrain",
                    "difficulty": "hard",
                    "explanation": "La surface de r√©paration mesure 16,5 m de profondeur et 40,3 m de largeur."
                },

                // Loi 2 : Le ballon
                {
                    "question": "Quel est le poids r√©glementaire d'un ballon en d√©but de match ?",
                    "options": ["350-400 g", "410-450 g", "450-500 g", "500-550 g"],
                    "answer": "410-450 g",
                    "theme": "Loi 2 - Ballon",
                    "difficulty": "medium",
                    "explanation": "Le ballon doit peser entre 410 et 450 grammes au d√©but du match."
                },
                {
                    "question": "Quelle est la pression r√©glementaire du ballon ?",
                    "options": ["0,6 - 1,1 atm", "1,2 - 1,5 atm", "0,4 - 0,7 atm", "1,0 - 1,4 atm"],
                    "answer": "0,6 - 1,1 atm",
                    "theme": "Loi 2 - Ballon",
                    "difficulty": "hard",
                    "explanation": "La pression du ballon doit √™tre comprise entre 0,6 et 1,1 atmosph√®re."
                },
                {
                    "question": "Qui d√©cide quel ballon officiel est utilis√© lors du match ?",
                    "options": ["Le capitaine de l'√©quipe locale", "L'arbitre", "Le d√©l√©gu√© du match", "La f√©d√©ration organisatrice"],
                    "answer": "L'arbitre",
                    "theme": "Loi 2 - Ballon",
                    "difficulty": "easy",
                    "explanation": "L'arbitre a l'autorit√© finale pour choisir le ballon utilis√© pendant le match."
                },

                // Loi 3 : Les joueurs
                {
                    "question": "Combien de joueurs minimum une √©quipe doit-elle avoir pour continuer le match ?",
                    "options": ["5", "6", "7", "8"],
                    "answer": "7",
                    "theme": "Loi 3 - Joueurs",
                    "difficulty": "easy",
                    "explanation": "Une √©quipe ne peut pas continuer avec moins de 7 joueurs sur le terrain."
                },
                {
                    "question": "Dans les comp√©titions officielles FIFA, combien de remplacements sont autoris√©s (hors prolongation) ?",
                    "options": ["3", "4", "5", "Illimit√©"],
                    "answer": "5",
                    "theme": "Loi 3 - Joueurs",
                    "difficulty": "easy",
                    "explanation": "Depuis 2020, 5 remplacements sont autoris√©s en comp√©tition officielle."
                },
                {
                    "question": "Un rempla√ßant entre sur le terrain sans autorisation de l'arbitre. D√©cision ?",
                    "options": ["Rien, on continue", "Coup franc direct contre son √©quipe + avertissement", "Coup franc indirect + avertissement", "Arr√™t, exclusion"],
                    "answer": "Coup franc direct contre son √©quipe + avertissement",
                    "theme": "Loi 3 - Joueurs",
                    "difficulty": "medium",
                    "explanation": "Entrer sans autorisation est sanctionn√© par un coup franc direct et un avertissement."
                },

                // Loi 4 : L'√©quipement des joueurs
                {
                    "question": "Les joueurs peuvent-ils porter des bijoux ?",
                    "options": ["Oui si scotch√©s", "Non, jamais", "Oui, si autoris√©s par le capitaine", "Oui, si cach√©s sous le maillot"],
                    "answer": "Non, jamais",
                    "theme": "Loi 4 - √âquipement",
                    "difficulty": "easy",
                    "explanation": "Aucun bijou n'est autoris√© pendant le match, m√™me recouvert."
                },
                {
                    "question": "O√π doivent √™tre port√©s les prot√®ge-tibias ?",
                    "options": ["Sous les chaussettes", "Sur les chaussettes", "Peu importe", "Coll√©s au short"],
                    "answer": "Sous les chaussettes",
                    "theme": "Loi 4 - √âquipement",
                    "difficulty": "easy",
                    "explanation": "Les prot√®ge-tibias doivent obligatoirement √™tre port√©s sous les chaussettes."
                },

                // Loi 5 : L'arbitre
                {
                    "question": "Quand l'autorit√© de l'arbitre commence-t-elle ?",
                    "options": ["Au coup d'envoi", "D√®s l'arriv√©e au stade", "√Ä la pr√©sentation des √©quipes", "Apr√®s tirage au sort"],
                    "answer": "D√®s l'arriv√©e au stade",
                    "theme": "Loi 5 - Arbitre",
                    "difficulty": "medium",
                    "explanation": "L'autorit√© de l'arbitre commence d√®s son arriv√©e sur le site du match."
                },
                {
                    "question": "L'arbitre peut-il revenir sur une d√©cision ?",
                    "options": ["Non, jamais", "Oui, tant que le jeu n'a pas repris", "Oui, uniquement si les deux capitaines sont d'accord", "Oui, seulement avant la pause"],
                    "answer": "Oui, tant que le jeu n'a pas repris",
                    "theme": "Loi 5 - Arbitre",
                    "difficulty": "medium",
                    "explanation": "L'arbitre peut modifier sa d√©cision tant que le jeu n'a pas repris ou que le match n'est pas termin√©."
                },

                // Loi 6 : Les autres officiels
                {
                    "question": "Qui assiste l'arbitre central pour signaler les hors-jeu et sorties de balle ?",
                    "options": ["Le d√©l√©gu√©", "Les arbitres assistants", "Le 4·µâ arbitre", "Les capitaines"],
                    "answer": "Les arbitres assistants",
                    "theme": "Loi 6 - Officiels",
                    "difficulty": "easy",
                    "explanation": "Les arbitres assistants aident l'arbitre pour les hors-jeu et les sorties de balle."
                },

                // Loi 7 : Dur√©e du match
                {
                    "question": "Combien de temps dure une rencontre de football r√©glementaire (hors prolongations) ?",
                    "options": ["80 minutes (2 √ó 40 min)", "90 minutes (2 √ó 45 min)", "100 minutes (2 √ó 50 min)", "120 minutes (2 √ó 60 min)"],
                    "answer": "90 minutes (2 √ó 45 min)",
                    "theme": "Loi 7 - Dur√©e",
                    "difficulty": "easy",
                    "explanation": "Un match dure 90 minutes, soit deux mi-temps de 45 minutes chacune."
                },
                {
                    "question": "Quelle est la dur√©e de la pause entre les deux mi-temps ?",
                    "options": ["Maximum 10 minutes", "Maximum 15 minutes", "Maximum 20 minutes", "Illimit√©e"],
                    "answer": "Maximum 15 minutes",
                    "theme": "Loi 7 - Dur√©e",
                    "difficulty": "easy",
                    "explanation": "La pause √† la mi-temps ne peut pas exc√©der 15 minutes."
                },

                // Loi 8 : Coup d'envoi
                {
                    "question": "Un but peut-il √™tre marqu√© directement sur un coup d'envoi ?",
                    "options": ["Oui, contre l'adversaire", "Oui, contre son propre camp", "Non", "Oui uniquement en prolongation"],
                    "answer": "Oui, contre l'adversaire",
                    "theme": "Loi 8 - Coup d'envoi",
                    "difficulty": "medium",
                    "explanation": "On peut marquer directement contre l'adversaire, mais pas contre son camp (corner accord√©)."
                },

                // Loi 11 : Hors-jeu
                {
                    "question": "Un joueur en position de hors-jeu re√ßoit une passe et ne joue pas le ballon, l'arbitre doit-il siffler ?",
                    "options": ["Oui", "Non", "Seulement s'il interf√®re avec le jeu", "Toujours"],
                    "answer": "Seulement s'il interf√®re avec le jeu",
                    "theme": "Loi 11 - Hors-jeu",
                    "difficulty": "medium",
                    "explanation": "√ätre en position de hors-jeu n'est pas une faute. Il faut interf√©rer avec le jeu, un adversaire, ou tirer avantage de cette position."
                },
                {
                    "question": "Un joueur peut-il √™tre en position de hors-jeu sur un corner ?",
                    "options": ["Oui", "Non", "Seulement dans la surface", "Selon la position"],
                    "answer": "Non",
                    "theme": "Loi 11 - Hors-jeu",
                    "difficulty": "easy",
                    "explanation": "Il n'y a pas de hors-jeu sur les corners, tout comme sur les remises en touche et les coups de pied de but."
                },

                // Loi 12 : Fautes et incorrections
                {
                    "question": "Une faute commise par n√©gligence doit √™tre sanctionn√©e comment ?",
                    "options": ["Coup franc", "Carton jaune", "Carton rouge", "Avantage"],
                    "answer": "Coup franc",
                    "theme": "Loi 12 - Fautes",
                    "difficulty": "easy",
                    "explanation": "Une faute par n√©gligence est sanctionn√©e uniquement par un coup franc, sans carton."
                },
                {
                    "question": "Un joueur qui conteste syst√©matiquement les d√©cisions de l'arbitre doit recevoir :",
                    "options": ["Un avertissement", "Un carton rouge", "Une simple r√©primande", "Rien"],
                    "answer": "Un avertissement",
                    "theme": "Loi 12 - Fautes",
                    "difficulty": "medium",
                    "explanation": "La contestation r√©p√©t√©e des d√©cisions est sanctionn√©e par un carton jaune pour comportement antisportif."
                },

                // Penalty
                {
                    "question": "Lors d'un penalty, le gardien bouge les deux pieds AVANT la frappe et arr√™te le ballon. D√©cision ?",
                    "options": ["Penalty √† retirer", "But accord√©", "Corner", "Faute non sanctionn√©e"],
                    "answer": "Penalty √† retirer",
                    "theme": "Penalty",
                    "difficulty": "hard",
                    "explanation": "Si le gardien ne respecte pas les r√®gles et que cela affecte le r√©sultat, le penalty doit √™tre retir√©."
                },
                {
                    "question": "Sur un penalty, tous les joueurs sauf le tireur et le gardien doivent √™tre :",
                    "options": ["Hors de la surface", "√Ä 9,15m du point de penalty", "Derri√®re la ligne de penalty", "Hors du cercle central"],
                    "answer": "Hors de la surface",
                    "theme": "Penalty",
                    "difficulty": "medium",
                    "explanation": "Tous les joueurs sauf le tireur et le gardien doivent √™tre √† l'ext√©rieur de la surface de r√©paration."
                },

                // Faits de jeu complexes
                {
                    "question": "Avant un match, on d√©couvre que les filets d'un but sont trou√©s. Que doit faire l'arbitre ?",
                    "options": ["Annuler le match", "Demander r√©paration avant le coup d'envoi", "Ignorer si les deux √©quipes sont d'accord", "Reporter le match"],
                    "answer": "Demander r√©paration avant le coup d'envoi",
                    "theme": "Gestion avant match",
                    "difficulty": "medium",
                    "explanation": "L'arbitre doit s'assurer que l'√©quipement est conforme avant de commencer le match."
                },
                {
                    "question": "Le ballon √©clate juste apr√®s avoir franchi la ligne de but. D√©cision ?",
                    "options": ["But valable", "But refus√©, balle √† terre", "Corner", "Renvoi de but"],
                    "answer": "But valable",
                    "theme": "Loi 2 - Ballon",
                    "difficulty": "hard",
                    "explanation": "Le but est valable car le ballon avait d√©j√† franchi la ligne avant d'√©clater."
                },
                {
                    "question": "Un joueur sort du terrain sans autorisation pour changer de chaussures. D√©cision ?",
                    "options": ["Rien", "Avertissement", "Coup franc indirect", "Autoriser √† revenir √† la prochaine sortie"],
                    "answer": "Avertissement",
                    "theme": "Loi 3 - Joueurs",
                    "difficulty": "medium",
                    "explanation": "Sortir du terrain sans autorisation est sanctionn√© par un avertissement."
                },
                {
                    "question": "Un joueur entre avec une cha√Æne visible autour du cou. D√©cision ?",
                    "options": ["Rien, on continue", "Lui demander de l'enlever avant de jouer", "Carton jaune imm√©diat", "Autoriser si couverte par scotch"],
                    "answer": "Lui demander de l'enlever avant de jouer",
                    "theme": "Loi 4 - √âquipement",
                    "difficulty": "easy",
                    "explanation": "Tous les bijoux doivent √™tre retir√©s avant de jouer, aucune exception."
                },
                {
                    "question": "Un arbitre donne un carton rouge mais sort par erreur un carton jaune. Que faire ?",
                    "options": ["Rien, la premi√®re d√©cision reste", "Il peut corriger si le jeu n'a pas repris", "Demander aux capitaines de choisir", "Reprendre par balle √† terre"],
                    "answer": "Il peut corriger si le jeu n'a pas repris",
                    "theme": "Loi 5 - Arbitre",
                    "difficulty": "medium",
                    "explanation": "L'arbitre peut corriger ses d√©cisions tant que le jeu n'a pas repris."
                }
            ],
            
            assistant: [
                // Collaboration avec l'arbitre central
                {
                    "question": "L'arbitre assistant doit lever son drapeau pour signaler un hors-jeu :",
                    "options": ["D√®s que le joueur est en position de hors-jeu", "Quand le joueur touche le ballon", "Quand il interf√®re avec le jeu", "Jamais"],
                    "answer": "Quand il interf√®re avec le jeu",
                    "theme": "Collaboration",
                    "difficulty": "medium",
                    "explanation": "L'assistant ne signale le hors-jeu que lorsque le joueur en position irr√©guli√®re interf√®re effectivement avec le jeu."
                },
                {
                    "question": "En cas de d√©saccord avec l'arbitre central, l'assistant doit :",
                    "options": ["Insister sur sa d√©cision", "Se soumettre √† la d√©cision de l'arbitre", "Demander l'avis du 4√®me arbitre", "Arr√™ter le jeu"],
                    "answer": "Se soumettre √† la d√©cision de l'arbitre",
                    "theme": "Collaboration",
                    "difficulty": "easy",
                    "explanation": "L'arbitre central prend toujours la d√©cision finale, m√™me apr√®s consultation de ses assistants."
                },
                {
                    "question": "L'arbitre assistant peut-il signaler une faute grave que l'arbitre n'a pas vue ?",
                    "options": ["Oui, toujours", "Non, jamais", "Seulement les cartons rouges", "Seulement dans sa zone"],
                    "answer": "Oui, toujours",
                    "theme": "Collaboration",
                    "difficulty": "medium",
                    "explanation": "L'assistant peut et doit signaler toute faute grave, comportement violent ou incident que l'arbitre n'a pas vu."
                },
                {
                    "question": "Pour signaler une faute, l'arbitre assistant doit :",
                    "options": ["Lever le drapeau", "Attendre le contact visuel", "Crier", "Utiliser le bip"],
                    "answer": "Attendre le contact visuel",
                    "theme": "Collaboration",
                    "difficulty": "hard",
                    "explanation": "L'assistant doit d'abord √©tablir un contact visuel avec l'arbitre avant de faire son signal."
                },
                {
                    "question": "L'arbitre assistant doit se placer :",
                    "options": ["Toujours sur la ligne de touche", "√Ä hauteur du dernier d√©fenseur", "√Ä hauteur de l'avant-dernier d√©fenseur", "Au centre du terrain"],
                    "answer": "√Ä hauteur de l'avant-dernier d√©fenseur",
                    "theme": "Collaboration",
                    "difficulty": "medium",
                    "explanation": "L'assistant se positionne √† hauteur de l'avant-dernier d√©fenseur pour juger correctement les hors-jeu."
                },

                // Remises en jeu
                {
                    "question": "Pour une remise en touche, l'arbitre assistant doit indiquer :",
                    "options": ["Seulement la direction", "L'√©quipe qui remet en jeu", "Le lieu exact", "Tout ce qui pr√©c√®de"],
                    "answer": "Tout ce qui pr√©c√®de",
                    "theme": "Remises en jeu",
                    "difficulty": "easy",
                    "explanation": "L'assistant indique la direction, l'√©quipe qui b√©n√©ficie de la remise et aide √† positionner correctement la remise en touche."
                },
                {
                    "question": "Le ballon sort en corner, l'assistant doit :",
                    "options": ["Lever le drapeau vers le corner", "Pointer vers le but", "Ne rien faire", "Regarder l'arbitre"],
                    "answer": "Lever le drapeau vers le corner",
                    "theme": "Remises en jeu",
                    "difficulty": "easy",
                    "explanation": "L'assistant signale le corner en levant le drapeau en direction de l'arc de cercle du corner appropri√©."
                },
                {
                    "question": "Sur un coup de pied de but, l'assistant v√©rifie :",
                    "options": ["Que le ballon sort de la surface", "La position des joueurs", "Les deux", "Rien"],
                    "answer": "Les deux",
                    "theme": "Remises en jeu",
                    "difficulty": "medium",
                    "explanation": "L'assistant s'assure que le ballon quitte la surface de r√©paration et que les joueurs respectent les r√®gles."
                },

                // Situations sp√©cifiques
                {
                    "question": "Un arbitre assistant signale une sortie de but mais l'arbitre central accorde corner. D√©cision finale ?",
                    "options": ["Assistant", "Arbitre central", "4√®me arbitre", "D√©l√©gu√©"],
                    "answer": "Arbitre central",
                    "theme": "Collaboration",
                    "difficulty": "medium",
                    "explanation": "L'arbitre central a toujours l'autorit√© finale sur toutes les d√©cisions du match."
                },
                {
                    "question": "Un arbitre assistant signale un hors-jeu, mais l'attaque se poursuit et un but est marqu√©. D√©cision ?",
                    "options": ["Hors-jeu confirm√©", "But valid√© si l'arbitre estime que le joueur n'√©tait pas fautif", "Corner", "Coup franc indirect"],
                    "answer": "But valid√© si l'arbitre estime que le joueur n'√©tait pas fautif",
                    "theme": "Collaboration",
                    "difficulty": "hard",
                    "explanation": "L'arbitre central peut ignorer le signal de l'assistant s'il juge que le hors-jeu n'√©tait pas correct."
                },
                {
                    "question": "L'arbitre assistant l√®ve son drapeau mais l'arbitre central ne le voit pas. D√©cision ?",
                    "options": ["Assistant d√©cide", "Jeu continue", "4√®me arbitre arr√™te le jeu", "VAR arr√™te le jeu"],
                    "answer": "Jeu continue",
                    "theme": "Collaboration",
                    "difficulty": "medium",
                    "explanation": "Si l'arbitre central ne voit pas le signal, le jeu continue normalement."
                },

                // Techniques de signalisation
                {
                    "question": "Les arbitres assistants l√®vent leur drapeau verticalement pour :",
                    "options": ["Une touche", "Un corner", "Un hors-jeu", "Une faute"],
                    "answer": "Un hors-jeu",
                    "theme": "Signalisation",
                    "difficulty": "easy",
                    "explanation": "Le drapeau vertical signale un hors-jeu."
                },
                {
                    "question": "Un arbitre assistant se trompe et signale hors-jeu sur une passe en retrait au gardien. L'arbitre siffle. D√©cision ?",
                    "options": ["Le jeu reprend par coup franc indirect", "L'arbitre peut reconna√Ætre l'erreur et donner balle √† terre", "On rejoue l'action", "Corner"],
                    "answer": "L'arbitre peut reconna√Ætre l'erreur et donner balle √† terre",
                    "theme": "Collaboration",
                    "difficulty": "hard",
                    "explanation": "L'arbitre peut corriger une erreur manifeste en donnant une balle √† terre pour reprendre √©quitablement."
                },

                // Gestion des situations difficiles
                {
                    "question": "En cas de panne de communication √©lectronique entre arbitres :",
                    "options": ["Le match est arr√™t√©", "On continue en utilisant les signaux visuels (drapeaux)", "L'arbitre demande au public de juger", "On rejoue le match"],
                    "answer": "On continue en utilisant les signaux visuels (drapeaux)",
                    "theme": "Collaboration",
                    "difficulty": "medium",
                    "explanation": "Les signaux visuels traditionnels restent le moyen principal de communication entre arbitres."
                }
            ]
        };

        // Variables globales
        let currentUser = {};
        let currentQuestionIndex = 0;
        let userAnswers = [];
        let score = 0;
        let currentQuestions = [];
        let quizMode = '';
        let timer = null;
        let timeLeft = 20;
        let questionStartTime = 0;
        let isAnswerRevealed = false;
        let wrongAnswers = [];

        // Gestion de la s√©lection de mode
        document.querySelectorAll('.mode-card').forEach(card => {
            card.addEventListener('click', function() {
                document.querySelectorAll('.mode-card').forEach(c => c.classList.remove('selected'));
                this.classList.add('selected');
                document.getElementById('quizMode').value = this.dataset.mode;
            });
        });

        // Gestion de l'√©cran de connexion
        document.getElementById('loginForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const firstName = document.getElementById('firstName').value.trim();
            const lastName = document.getElementById('lastName').value.trim();
            const role = document.getElementById('role').value;
            const level = document.getElementById('level').value;
            const mode = document.getElementById('quizMode').value;
            
            if (firstName && lastName && role && level && mode) {
                currentUser = { firstName, lastName, role, level };
                quizMode = mode;
                startQuiz();
            }
        });

        function startQuiz() {
            document.getElementById('loginScreen').classList.add('hidden');
            document.getElementById('quizScreen').classList.remove('hidden');
            
            // S√©lectionner les questions selon le r√¥le
            currentQuestions = [...questionsByRole[currentUser.role]] || [];
            
            // M√©langer les questions
            currentQuestions = currentQuestions.sort(() => Math.random() - 0.5);
            
            // Prendre seulement 15 questions
            currentQuestions = currentQuestions.slice(0, 15);
            
            // Afficher les infos utilisateur
            document.getElementById('userDisplay').textContent = `${currentUser.firstName} ${currentUser.lastName}`;
            document.getElementById('roleDisplay').textContent = ` - ${getRoleDisplayName(currentUser.role)}`;
            document.getElementById('levelDisplay').textContent = ` - Niveau ${currentUser.level}`;
            document.getElementById('modeDisplay').textContent = ` - Mode ${quizMode === 'training' ? 'Entra√Ænement' : 'Examen'}`;
            
            // Afficher/masquer le timer selon le mode
            if (quizMode === 'exam') {
                document.getElementById('timerDisplay').classList.remove('hidden');
            } else {
                document.getElementById('timerDisplay').classList.add('hidden');
            }
            
            // R√©initialiser les variables
            currentQuestionIndex = 0;
            userAnswers = [];
            score = 0;
            wrongAnswers = [];
            isAnswerRevealed = false;
            
            displayQuestion();
        }

        function getRoleDisplayName(role) {
            const roleNames = {
                'central': 'Arbitre Central',
                'assistant': 'Arbitre Assistant'
            };
            return roleNames[role] || role;
        }

        function displayQuestion() {
            if (currentQuestions.length === 0) {
                alert('Aucune question disponible pour ce r√¥le.');
                return;
            }

            const question = currentQuestions[currentQuestionIndex];
            isAnswerRevealed = false;
            
            // Mettre √† jour le progress
            document.getElementById('progressText').textContent = `Question ${currentQuestionIndex + 1} sur ${currentQuestions.length}`;
            document.getElementById('questionNumber').textContent = currentQuestionIndex + 1;
            
            // Afficher le th√®me et la difficult√©
            document.getElementById('themeBadge').textContent = question.theme;
            const difficultyBadge = document.getElementById('difficultyBadge');
            difficultyBadge.textContent = question.difficulty;
            difficultyBadge.className = `difficulty-badge difficulty-${question.difficulty}`;
            
            // Afficher la question
            document.getElementById('questionText').textContent = question.question;
            
            // Masquer l'explication
            document.getElementById('answerExplanation').classList.add('hidden');
            
            // Cr√©er les options
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            
            question.options.forEach((option, index) => {
                const optionElement = document.createElement('div');
                optionElement.className = 'option';
                optionElement.textContent = option;
                optionElement.addEventListener('click', () => selectOption(index, option));
                
                // Restaurer la s√©lection si elle existe
                if (userAnswers[currentQuestionIndex] === option) {
                    optionElement.classList.add('selected');
                }
                
                optionsContainer.appendChild(optionElement);
            });
            
            // D√©marrer le timer en mode examen
            if (quizMode === 'exam') {
                startTimer();
            }
            
            // G√©rer les boutons de navigation
            updateNavigationButtons();
        }

        function startTimer() {
            timeLeft = 20;
            questionStartTime = Date.now();
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeLeft--;
                updateTimerDisplay();
                
                if (timeLeft <= 0) {
                    clearInterval(timer);
                    // Pas de r√©ponse s√©lectionn√©e, passer √† la question suivante
                    if (!userAnswers[currentQuestionIndex]) {
                        userAnswers[currentQuestionIndex] = null;
                    }
                    setTimeout(() => {
                        if (currentQuestionIndex < currentQuestions.length - 1) {
                            nextQuestion();
                        } else {
                            finishQuiz();
                        }
                    }, 1000);
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const timerElement = document.getElementById('timerDisplay');
            timerElement.textContent = `${timeLeft}s`;
            
            if (timeLeft <= 5) {
                timerElement.className = 'timer';
            } else if (timeLeft <= 10) {
                timerElement.className = 'timer warning';
            } else {
                timerElement.className = 'timer normal';
            }
        }

        function selectOption(index, option) {
            if (isAnswerRevealed && quizMode === 'training') {
                return; // Emp√™cher la s√©lection apr√®s r√©v√©lation de la r√©ponse
            }
            
            // D√©s√©lectionner toutes les options
            document.querySelectorAll('.option').forEach(opt => {
                opt.classList.remove('selected');
            });
            
            // S√©lectionner l'option cliqu√©e
            document.querySelectorAll('.option')[index].classList.add('selected');
            
            // Sauvegarder la r√©ponse
            userAnswers[currentQuestionIndex] = option;
            
            // En mode entra√Ænement, afficher imm√©diatement la correction
            if (quizMode === 'training') {
                showAnswerFeedback();
            }
            
            // En mode examen, arr√™ter le timer
            if (quizMode === 'exam' && timer) {
                clearInterval(timer);
            }
        }

        function showAnswerFeedback() {
            const question = currentQuestions[currentQuestionIndex];
            const userAnswer = userAnswers[currentQuestionIndex];
            const correctAnswer = question.answer;
            
            isAnswerRevealed = true;
            
            // Colorer les options
            document.querySelectorAll('.option').forEach(option => {
                const optionText = option.textContent;
                
                if (optionText === correctAnswer) {
                    option.classList.add('correct');
                    option.innerHTML += ' <span class="feedback-icon">‚úì</span>';
                } else if (optionText === userAnswer && userAnswer !== correctAnswer) {
                    option.classList.add('incorrect');
                    option.innerHTML += ' <span class="feedback-icon">‚úó</span>';
                }
                
                // D√©sactiver le clic
                option.style.pointerEvents = 'none';
            });
            
            // Afficher l'explication
            const explanationElement = document.getElementById('answerExplanation');
            explanationElement.innerHTML = `<strong>Explication :</strong> ${question.explanation}`;
            explanationElement.classList.remove('hidden');
        }

        function updateNavigationButtons() {
            const prevBtn = document.getElementById('prevBtn');
            const nextBtn = document.getElementById('nextBtn');
            const finishBtn = document.getElementById('finishBtn');
            
            // Bouton pr√©c√©dent
            prevBtn.disabled = currentQuestionIndex === 0;
            
            // Boutons suivant/terminer
            if (currentQuestionIndex === currentQuestions.length - 1) {
                nextBtn.classList.add('hidden');
                finishBtn.classList.remove('hidden');
            } else {
                nextBtn.classList.remove('hidden');
                finishBtn.classList.add('hidden');
            }
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                if (timer) {
                    clearInterval(timer);
                }
                currentQuestionIndex--;
                displayQuestion();
            }
        }

        function nextQuestion() {
            if (currentQuestionIndex < currentQuestions.length - 1) {
                if (timer) {
                    clearInterval(timer);
                }
                currentQuestionIndex++;
                displayQuestion();
            }
        }

        function finishQuiz() {
            if (timer) {
                clearInterval(timer);
            }
            
            // Calculer le score et analyser les erreurs
            score = 0;
            wrongAnswers = [];
            const themeErrors = {};
            
            for (let i = 0; i < currentQuestions.length; i++) {
                const question = currentQuestions[i];
                const userAnswer = userAnswers[i];
                const correctAnswer = question.answer;
                
                if (userAnswer === correctAnswer) {
                    score++;
                } else {
                    wrongAnswers.push({
                        question: question.question,
                        userAnswer: userAnswer || "Pas de r√©ponse",
                        correctAnswer: correctAnswer,
                        explanation: question.explanation,
                        theme: question.theme
                    });
                    
                    // Compter les erreurs par th√®me
                    if (!themeErrors[question.theme]) {
                        themeErrors[question.theme] = 0;
                    }
                    themeErrors[question.theme]++;
                }
            }
            
            showResults(themeErrors);
        }

        function showResults(themeErrors) {
            document.getElementById('quizScreen').classList.add('hidden');
            document.getElementById('resultScreen').classList.remove('hidden');
            
            // Afficher les infos utilisateur
            document.getElementById('finalUserDisplay').textContent = `${currentUser.firstName} ${currentUser.lastName}`;
            document.getElementById('finalRoleDisplay').textContent = ` - ${getRoleDisplayName(currentUser.role)}`;
            document.getElementById('finalLevelDisplay').textContent = ` - Niveau ${currentUser.level}`;
            document.getElementById('finalModeDisplay').textContent = ` - Mode ${quizMode === 'training' ? 'Entra√Ænement' : 'Examen'}`;
            
            // Calculer et afficher le pourcentage
            const percentage = Math.round((score / currentQuestions.length) * 100);
            
            // Animer le cercle de score
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.style.setProperty('--score', percentage);
            
            document.getElementById('scorePercentage').textContent = `${percentage}%`;
            document.getElementById('scoreText').textContent = `${score}/${currentQuestions.length}`;
            
            // Message de feedback
            let feedback = '';
            if (percentage >= 90) {
                feedback = 'üèÜ Excellent ! Vous ma√Ætrisez parfaitement les r√®gles !';
            } else if (percentage >= 70) {
                feedback = ' Tr√®s bien ! Continuez comme √ßa !';
            } else if (percentage >= 50) {
                feedback = ' Pas mal ! Il y a encore quelques points √† revoir.';
            } else {
                feedback = ' Continuez √† √©tudier les r√®gles, vous allez progresser !';
            }
            
            document.getElementById('feedback').textContent = feedback;
            
            // Afficher l'analyse des faiblesses
            if (Object.keys(themeErrors).length > 0) {
                const weaknessElement = document.getElementById('weaknessAnalysis');
                const weaknessList = document.getElementById('weaknessList');
                
                weaknessList.innerHTML = '';
                Object.entries(themeErrors).forEach(([theme, errorCount]) => {
                    const weaknessItem = document.createElement('div');
                    weaknessItem.className = 'weakness-item';
                    weaknessItem.innerHTML = `<strong>${theme}</strong> : ${errorCount} erreur${errorCount > 1 ? 's' : ''} √† revoir`;
                    weaknessList.appendChild(weaknessItem);
                });
                
                weaknessElement.classList.remove('hidden');
            }
            
            // Afficher les corrections d√©taill√©es en mode examen ou si il y a des erreurs
            if (wrongAnswers.length > 0 && (quizMode === 'exam' || quizMode === 'training')) {
                const correctionElement = document.getElementById('correctionDetails');
                const correctionList = document.getElementById('correctionList');
                
                correctionList.innerHTML = '';
                wrongAnswers.forEach(error => {
                    const correctionItem = document.createElement('div');
                    correctionItem.className = 'correction-item wrong';
                    correctionItem.innerHTML = `
                        <h4>${error.question}</h4>
                        <p><strong>Votre r√©ponse :</strong> <span class="user-answer">${error.userAnswer}</span></p>
                        <p><strong>Bonne r√©ponse :</strong> <span class="correct-answer">${error.correctAnswer}</span></p>
                        <p><strong>Explication :</strong> ${error.explanation}</p>
                    `;
                    correctionList.appendChild(correctionItem);
                });
                
                correctionElement.classList.remove('hidden');
            }
        }

        function newTest() {
            // Remettre √† z√©ro pour faire un nouveau test
            document.getElementById('resultScreen').classList.add('hidden');
            document.getElementById('loginScreen').classList.remove('hidden');
            
            // R√©initialiser le formulaire mais garder les infos utilisateur
            document.getElementById('firstName').value = currentUser.firstName;
            document.getElementById('lastName').value = currentUser.lastName;
            document.getElementById('role').value = currentUser.role;
            document.getElementById('level').value = currentUser.level;
            
            // D√©s√©lectionner le mode
            document.querySelectorAll('.mode-card').forEach(c => c.classList.remove('selected'));
            document.getElementById('quizMode').value = '';
        }

        function restartQuiz() {
            document.getElementById('resultScreen').classList.add('hidden');
            document.getElementById('loginScreen').classList.remove('hidden');
            
            // R√©initialiser compl√®tement le formulaire
            document.getElementById('loginForm').reset();
            document.querySelectorAll('.mode-card').forEach(c => c.classList.remove('selected'));
        }
    </script>
	<!-- POPUP HTML -->
<div id="popup" style="
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background-color: #000;
    border: 4px solid gold;
    color: white;
    padding: 30px;
    max-width: 500px;
    width: 90%;
    z-index: 1000;
    text-align: center;
    font-weight: bold;
    box-shadow: 0 0 15px gold;
    border-radius: 10px;
    display: none;
">
    Coll√®gues arbitres, une base de 500 questions est √† votre disposition pour renforcer nos connaissances.<br><br>
    Chaque quiz comporte 15 questions, √† choisir en mode entrainement avec des explications ou en mode examen.<br><br>
    En fin de test, vous verrez votre pourcentage de r√©ussite ainsi que les explications pour apprendre de vos erreurs.<br><br>
    üéØ √Ä vous de jouer : tentez le quiz et mesurez vos progr√®s !<br><br>
    <button onclick="closePopup()" style="
        margin-top: 10px;
        padding: 10px 20px;
        background-color: gold;
        border: none;
        color: black;
        font-weight: bold;
        cursor: pointer;
        border-radius: 5px;
    ">Fermer</button>
</div>

<script>
    // Fonction pour afficher le popup au chargement de la page
    window.onload = function() {
        document.getElementById("popup").style.display = "block";
    };

    // Fonction pour fermer le popup
    function closePopup() {
        document.getElementById("popup").style.display = "none";
    }
</script>

</body>
</html>
